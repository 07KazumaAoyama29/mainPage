{% extends 'todo/base.html' %}

{% block header %}
  <h3>{{ action_item.title }}</h3>
  <div class="mt-3 p-3 bg-light rounded">
    <p class="mb-1"><strong>目標 (Specific):</strong> {{ action_item.text1|default:"(未設定)" }}</p>
    <p class="mb-1"><strong>測定可能 (Measurable):</strong> {{ action_item.text2|default:"(未設定)" }}</p>
    <p class="mb-0"><strong>達成可能 (Achievable):</strong> {{ action_item.text3|default:"(未設定)" }}</p>
  </div>
{% endblock header %}

{% block content %}
  <h4 class="mb-3">関連スケジュール一覧</h4>

  {% for schedule in schedules %}
    <div class="card mb-3">
      <div class="card-header d-flex justify-content-between align-items-center">
        <strong>{{ schedule.start_time|date:"Y/m/d H:i" }} - {{ schedule.end_time|date:"H:i" }}</strong>
        <a href="{% url 'todo:schedule_detail' pk=schedule.pk %}" class="btn btn-sm btn-outline-primary">
          詳細とタスク管理
        </a>
      </div>
      <ul class="list-group list-group-flush">
        {% for task in schedule.tasks.all %}
          <li class="list-group-item {% if task.completed %}list-group-item-light text-muted text-decoration-line-through{% endif %}">
            {{ task.title }}
          </li>
        {% empty %}
          <li class="list-group-item">このスケジュールにはタスクがまだありません。</li>
        {% endfor %}
      </ul>
    </div>
  {% empty %}
    <div class="alert alert-info">
      この「やること」はまだスケジュールされていません。
    </div>
  {% endfor %}

  <a href="{% url 'todo:action_item_list' %}" class="btn btn-secondary mt-3">一覧に戻る</a>
{% endblock content %}